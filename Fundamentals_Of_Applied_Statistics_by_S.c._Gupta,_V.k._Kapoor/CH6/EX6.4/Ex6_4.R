#Page no. 6.24
rm(list=ls(all=T))
r<-4;t<-6
x<-c(24.7,27.7,20.6,16.2,16.2,24.9,22.7,28.8,27.3,15,22.5,17,26.3,19.6,38.5,36.8,39.5,15.4,17.7,31,28.5,14.1,34.9,22.6)
blk<-gl(4,6)
trt<-factor(c(1,3,2,4,5,6,3,2,1,4,6,5,6,4,1,3,2,5,5,2,1,4,3,6))
df<-data.frame(blk,trt,x)
fit<-anova(lm(x~trt+blk,data=df))
fit
CD<-sqrt(2*fit[3,3]/r)*abs(qt(0.025,fit[3,1]))
CD
E<-(r*(t-1)*fit[3,3]+(r-1)*fit[2,3])/((r*t-1)*fit[3,3])
E
