#page no: 794
library(pracma)
I_1 = 1000 ;
Z_pu = 0.04 ;
I_pu = 2.08*exp(1i*(-90)*pi/180) ;
kVA_Bg1 = 6000 ;
kVA_Bg2 = 4000 ;
N2 = 2.4 ;
N1 = 24 ;
N3 = 24 ;
N4 = 12 ;
kVA_B = 2080 ;
n1 = N2/N1 ;
n2 = N3/N4 ;
kV_BL_L1 = 2.5 ;
kV_BL_L2 = kV_BL_L1/n1 ;
kV_BL_L3 = kV_BL_L2/n2 ;
Z_B1 = (kV_BL_L1)^(2) * 1000/(kVA_B) ;
Z_B2 = (kV_BL_L2)^(2) * 1000/(kVA_B) ;
Z_B3 = (kV_BL_L3)^(2) * 1000/(kVA_B) ;
I_B1 = kVA_B/(sqrt(3)*kV_BL_L1) ;
I_B2 = kVA_B/(sqrt(3)*kV_BL_L2) ;
I_B3 = kVA_B/(sqrt(3)*kV_BL_L3) ;
I_2 = (n1) * I_1 ;
I_4 = (n2) * I_2 ;
I_pu_3ckt = abs(I_pu) ;
kV_B1 = N2 ;
kV_B2 = N4 ;
Z_pu_T1 = (1i)*Z_pu*(kVA_B/kVA_Bg1)*(kV_B1/kV_BL_L1)^(2) ;
Z_pu_T2 = (1i)*Z_pu*(kVA_B/kVA_Bg2)*(kV_B2/kV_BL_L3)^(2) ;
V1 = kV_B1/kV_BL_L1 ;
V2 = V1 - I_pu * (Z_pu_T1) ;
V4 = V2 - I_pu * (Z_pu_T2) ;
S1 = V1 * abs(I_pu) ;
S2 = V2 * abs(I_pu) ;
S4 = V4 * abs(I_pu) ;
print(kVA_B) ;
print(kV_BL_L1) ;
print(kV_BL_L2) ;
print(kV_BL_L3) ;
print(Z_B1) ;
print(Z_B2) ;
print(Z_B3) ;
print(I_B1) ;
print(I_B2) ;
print(I_B3) ;
print(I_1) ;
print(I_2) ;
print(I_4) ;
print(I_pu_3ckt) ;
print(abs(Z_pu_T1)) ;
print(abs(Z_pu_T2)) ;
cat(abs(V1),atan2d(Im(V1),Re(V1))) ;
cat(abs(V2),atan2d(Im(V2),Re(V2))) ;
cat(abs(V4),atan2d(Im(V4),Re(V4))) ;
print(S1) ;
print(S2) ;
print(S4) ;
cat(kVA_B,kVA_B,kVA_B) ;
cat(kV_BL_L1,kV_BL_L2,kV_BL_L3) ;
cat(Z_B1,Z_B2,Z_B3) ;
cat(I_B1,I_B2,I_B3) ;
cat(I_1,I_2,I_4) ;
cat(I_pu_3ckt,I_pu_3ckt,I_pu_3ckt) ;
cat(abs(V1),abs(V2),abs(V4)) ;
cat(S1,S2,S4) ;
