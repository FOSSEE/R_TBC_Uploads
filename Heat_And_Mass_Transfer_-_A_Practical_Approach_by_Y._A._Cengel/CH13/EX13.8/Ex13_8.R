# page no: 734

library(pracma)
ro = 1
H = 1;
e1 = 0.8
e2 = 0.4;
T1 = 700
T2 = 500;
T3 = 400;
F11 = 0
F12 = 0.38;
A1 = pi*(ro^2);
A2 = A1;
A3 = 2*pi*ro*H;
F13 = 1-F11-F12;
F21 = F12;
F31 = F13*(A1/A3);
F23 = F13;
F32 = F31;
f = function(J){
  i = c(0,0,0)
i[1] = J[1]+(((1-e1)/e1)*((F12*(J[1]-(J[2])))+(F13*((J[1])-(J[3])))))-((T1^4)*(5.67*10^(-8)));
i[2] = J[2]+(((1-e2)/e2)*((F21*(J[2]-J[1]))+(F23*(J[2]-J[3]))))-((T2^4)*(5.67*10^(-8)));
i[3] = J[3]-((T3^4)*(5.67*10^(-8)));
return(i)
}
J = fsolve(f, c(1,1,1))$x
print(J)
Q1 = A1*((F12*(J[1]-J[2]))+(F13*(J[1]-J[3])));
Q2 = A2*((F21*(J[2]-J[1]))+(F13*(J[2]-J[3])));
Q3 = A3*((F31*(J[3]-J[1]))+(F32*(J[3]-J[2])));
cat(Q3/1000,Q2/1000,Q1/1000)

#           "The answer may slightly vary due to rounding off values."   
