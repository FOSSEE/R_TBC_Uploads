# page no.183

LnU <- function(A){
	L <- diag(4)
	U <- A
	U[2,] <- U[2,] - (2)*U[1,]
	L[2,1] <- 2
	U[3,] <- U[3,] - (1)*U[1,]
	L[3,1] <- 1
	U[4,] <- U[4,] + (3)*U[1,]
	L[4,1] <- -3
	U[3,] <- U[3,] - (1/2)*U[2,]
	L[3,2] <- 1/2
	U[4,] <- U[4,] - (4)*U[2,]
	L[4,2] <- 4
	U[4,] <- U[4,] + (1)*U[3,]
	L[4,3] <- -1
	LU <- L%*%U
	return (LU)
}

A <- matrix(c(3, 1, 3, -4, 6, 4, 8, -10, 3, 2,
     5, -1, -9, 5, -2, -4), 4, 4, TRUE)
LU <- LnU(A)
if(all(A == LU)){
	print(LU)
}
